{"version":3,"file":"tree.min.js","sources":["../src/tree.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module for managing curriculum tree interactions.\n *\n * @module     local_curriculum/tree\n * @copyright  2026 David Herney @ BambuCo\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n    'use strict';\n\n    const SELECTOR_TOGGLE = '.curriculum-tree-toggle';\n    const SELECTOR_CHILDREN = '.curriculum-tree-children';\n    const SELECTOR_NODE = '.curriculum-tree-node';\n    const SELECTOR_EXPAND_ALL = '.curriculum-tree-expand-all';\n    const SELECTOR_COLLAPSE_ALL = '.curriculum-tree-collapse-all';\n    const CLASS_COLLAPSED = 'curriculum-tree-collapsed';\n\n    return {\n        /**\n         * Initializes tree interactions.\n         */\n        init: function() {\n            this.attachEventHandlers();\n        },\n\n        /**\n         * Attaches event handlers for tree interactions.\n         */\n        attachEventHandlers: function() {\n            $(document).on('click', SELECTOR_TOGGLE, this.handleToggleClick.bind(this));\n            $(document).on('click', SELECTOR_EXPAND_ALL, this.handleExpandAll.bind(this));\n            $(document).on('click', SELECTOR_COLLAPSE_ALL, this.handleCollapseAll.bind(this));\n        },\n\n        /**\n         * Handles toggle button clicks to expand/collapse nodes.\n         *\n         * @param {Object} e - Event object\n         */\n        handleToggleClick: function(e) {\n            e.preventDefault();\n            const $button = $(e.currentTarget);\n            const $node = $button.closest(SELECTOR_NODE);\n            const $children = $node.children(SELECTOR_CHILDREN);\n\n            if ($children.length === 0) {\n                return;\n            }\n\n            const isExpanded = $button.attr('aria-expanded') === 'true';\n            const newState = !isExpanded;\n\n            $button.attr('aria-expanded', newState.toString());\n\n            if (newState) {\n                $node.removeClass(CLASS_COLLAPSED);\n                $children.slideDown(200);\n            } else {\n                $node.addClass(CLASS_COLLAPSED);\n                $children.slideUp(200);\n            }\n        },\n\n        /**\n         * Expands all nodes in the tree.\n         *\n         * @param {Object} e - Event object\n         */\n        handleExpandAll: function(e) {\n            e.preventDefault();\n            const $tree = $(e.currentTarget).closest('.curriculum-tree');\n            const $toggles = $tree.find(SELECTOR_TOGGLE);\n\n            $toggles.each((index, toggle) => {\n                const $toggle = $(toggle);\n                const $node = $toggle.closest(SELECTOR_NODE);\n                const $children = $node.children(SELECTOR_CHILDREN);\n\n                if ($children.length > 0) {\n                    $toggle.attr('aria-expanded', 'true');\n                    $node.removeClass(CLASS_COLLAPSED);\n                    $children.slideDown(200);\n                }\n            });\n        },\n\n        /**\n         * Collapses all nodes in the tree.\n         *\n         * @param {Object} e - Event object\n         */\n        handleCollapseAll: function(e) {\n            e.preventDefault();\n            const $tree = $(e.currentTarget).closest('.curriculum-tree');\n            const $toggles = $tree.find(SELECTOR_TOGGLE);\n\n            $toggles.each((index, toggle) => {\n                const $toggle = $(toggle);\n                const $node = $toggle.closest(SELECTOR_NODE);\n                const $children = $node.children(SELECTOR_CHILDREN);\n\n                if ($children.length > 0) {\n                    $toggle.attr('aria-expanded', 'false');\n                    $node.addClass(CLASS_COLLAPSED);\n                    $children.slideUp(200);\n                }\n            });\n        },\n    };\n});\n"],"names":["define","$","CLASS_COLLAPSED","init","this","attachEventHandlers","document","on","handleToggleClick","bind","handleExpandAll","handleCollapseAll","e","preventDefault","$button","currentTarget","$node","closest","$children","children","length","newState","attr","toString","removeClass","slideDown","addClass","slideUp","find","each","index","toggle","$toggle"],"mappings":";;;;;;;AAuBAA,+BAAO,CAAC,UAAW,SAASC,GAGxB,MAKMC,gBAAkB,4BAExB,MAAO,CAIHC,KAAM,WACFC,KAAKC,qBACR,EAKDA,oBAAqB,WACjBJ,EAAEK,UAAUC,GAAG,QAnBC,0BAmByBH,KAAKI,kBAAkBC,KAAKL,OACrEH,EAAEK,UAAUC,GAAG,QAjBK,8BAiByBH,KAAKM,gBAAgBD,KAAKL,OACvEH,EAAEK,UAAUC,GAAG,QAjBO,gCAiByBH,KAAKO,kBAAkBF,KAAKL,MAC9E,EAODI,kBAAmB,SAASI,GACxBA,EAAEC,iBACF,MAAMC,QAAUb,EAAEW,EAAEG,eACdC,MAAQF,QAAQG,QA9BR,yBA+BRC,UAAYF,MAAMG,SAhCN,6BAkClB,GAAyB,IAArBD,UAAUE,OACV,OAGJ,MACMC,WAD+C,SAAlCP,QAAQQ,KAAK,kBAGhCR,QAAQQ,KAAK,gBAAiBD,SAASE,YAEnCF,UACAL,MAAMQ,YAAYtB,iBAClBgB,UAAUO,UAAU,OAEpBT,MAAMU,SAASxB,iBACfgB,UAAUS,QAAQ,KAEzB,EAODjB,gBAAiB,SAASE,GACtBA,EAAEC,iBACYZ,EAAEW,EAAEG,eAAeE,QAAQ,oBAClBW,KA7DP,2BA+DPC,KAAK,CAACC,MAAOC,UAClB,MAAMC,QAAU/B,EAAE8B,QACZf,MAAQgB,QAAQf,QA/DZ,yBAgEJC,UAAYF,MAAMG,SAjEV,6BAmEVD,UAAUE,OAAS,IACnBY,QAAQV,KAAK,gBAAiB,QAC9BN,MAAMQ,YAAYtB,iBAClBgB,UAAUO,UAAU,OAG/B,EAODd,kBAAmB,SAASC,GACxBA,EAAEC,iBACYZ,EAAEW,EAAEG,eAAeE,QAAQ,oBAClBW,KApFP,2BAsFPC,KAAK,CAACC,MAAOC,UAClB,MAAMC,QAAU/B,EAAE8B,QACZf,MAAQgB,QAAQf,QAtFZ,yBAuFJC,UAAYF,MAAMG,SAxFV,6BA0FVD,UAAUE,OAAS,IACnBY,QAAQV,KAAK,gBAAiB,SAC9BN,MAAMU,SAASxB,iBACfgB,UAAUS,QAAQ,OAG9B,EAER"}